<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>BGM 로딩 최종 테스트</title>
</head>
<body>
    <h1>BGM 로딩 최종 테스트</h1>
    <p>이 페이지는 오직 BGM 로딩 기능 하나만 테스트합니다. 아래에 오디오 파형이 나타나면 성공입니다.</p>
    
    <div id="waveform" style="border: 1px solid #ddd; background-color: #333;"></div>
    <br>
    <button id="playBtn" style="padding: 10px 20px;">재생/일시정지</button>
    <p id="loading-status">BGM 로딩 중...</p>

    <!-- WaveSurfer.js 라이브러리 로드 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/6.4.0/wavesurfer.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const loadingStatus = document.getElementById('loading-status');

            // WaveSurfer 초기화
            const wavesurfer = WaveSurfer.create({
                container: '#waveform',
                waveColor: '#ddd',
                progressColor: '#e82c43',
                cursorColor: '#fff'
            });

            // 오류 발생 시 이벤트 처리
            wavesurfer.on('error', function (err) {
                console.error('WaveSurfer Error:', err);
                loadingStatus.textContent = '오류 발생: ' + err;
                alert('오류가 발생했습니다. 콘솔 창을 확인해주세요. 오류: ' + err);
            });

            // 로딩 성공 시 이벤트 처리
            wavesurfer.on('ready', function () {
                loadingStatus.textContent = '성공! BGM 파형이 로드되었습니다.';
                console.log('BGM 로딩 성공!');
                alert('성공! BGM 파형이 로드되었습니다.');
            });
            
            // 재생/일시정지 버튼
            document.getElementById('playBtn').addEventListener('click', function () {
                wavesurfer.playPause();
            });

            // sunsaktool-final 서버의 파일로 직접 로드 시도
            const audioUrl = 'https://sunsaktool-final.netlify.app/cute-puppy.mp3';
            loadingStatus.textContent = `BGM 로딩 시도 중... (${audioUrl})`;
            wavesurfer.load(audioUrl);
        });
    </script>
</body>
</html>
